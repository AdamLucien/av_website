<!doctype html>
<html lang="cs">
<head>
<base href="/av_website/">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>AV ¬∑ D√©≈°≈• n√°s spojil</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="assets/site.css" />

  <script defer src="assets/data.js"></script>
  <script defer src="assets/shared-bg.js"></script>
  <script defer src="assets/partials/header.js?v=1"></script>

  <style>
    .bg-mesh{background:
      radial-gradient(900px 600px at 20% -20%, rgba(139,92,246,.20), transparent 60%),
      radial-gradient(900px 600px at 80% 120%, rgba(34,211,238,.18), transparent 60%),
      linear-gradient(180deg,#0a0f1f,#0e1220);}

    .cardg{border-radius:16px;padding:16px;background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.12);box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .badge{display:inline-block;padding:4px 10px;border-radius:999px;background:rgba(15,23,51,.75);
      border:1px solid rgba(147,197,253,.22);color:#a9b8ff;font-size:12px}
    .rule{height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.12),transparent)}

    .kpi{display:flex;flex-direction:column;gap:6px}
    .kpi .num{font-size:clamp(28px,5vw,34px);font-weight:800;letter-spacing:.2px}
    .kpi .hint{color:#cfd7ff}
    .chip{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;
      background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);color:#dbe5ff;font-size:13px}
  </style>
</head>

<body class="bg-mesh text-white selection:bg-amethyst/30">
  <div id="app-header"></div>

  <main class="container section relative z-10">
    <!-- Hlava -->
    <section class="mb-6">
      <h1 id="ttl" class="grad-text text-3xl md:text-5xl font-black mb-2" data-reveal>D√©≈°≈• n√°s spojil</h1>
      <p id="sub" class="text-aura/90 mb-4" data-reveal>‚Äî</p>
      <div id="facts" class="flex flex-wrap gap-2" data-reveal></div>
    </section>

    <div class="rule my-6" aria-hidden="true"></div>

    <!-- KPI -->
    <section class="grid md:grid-cols-3 gap-4 mb-10">
      <div class="cardg kpi" data-reveal>
        <div class="hint" id="k_lbl_total">Zpr√°v celkem</div>
        <div id="k_total" class="num">0</div>
        <div id="k_desc_total" class="text-white/70 text-sm">‚Äî</div>
      </div>
      <div class="cardg kpi" data-reveal>
        <div class="hint" id="k_lbl_days">Dny aktivn√≠</div>
        <div id="k_days" class="num">0</div>
        <div id="k_desc_days" class="text-white/70 text-sm">‚Äî</div>
      </div>
      <div class="cardg kpi" data-reveal>
        <div class="hint" id="k_lbl_avg">Pr≈Ømƒõr / den</div>
        <div id="k_avg" class="num">0</div>
        <div id="k_desc_avg" class="text-white/70 text-sm">‚Äî</div>
      </div>

      <div class="cardg kpi md:col-span-3 grid md:grid-cols-3 gap-4" data-reveal>
        <div class="kpi">
          <div class="hint" id="k_lbl_pos">Pozitivn√≠</div>
          <div id="k_pos" class="num">0%</div>
          <div id="k_desc_pos" class="text-white/70 text-sm">‚Äî</div>
        </div>
        <div class="kpi">
          <div class="hint" id="k_lbl_neg">Negativn√≠</div>
          <div id="k_neg" class="num">0%</div>
          <div id="k_desc_neg" class="text-white/70 text-sm">‚Äî</div>
        </div>
        <div class="kpi">
          <div class="hint" id="k_lbl_gap">Nejdel≈°√≠ ticho</div>
          <div id="k_gap" class="num">0 h</div>
          <div id="k_desc_gap" class="text-white/70 text-sm">‚Äî</div>
        </div>
      </div>
    </section>

    <!-- Miln√≠ky -->
    <section class="mb-10">
      <h2 class="text-xl md:text-2xl font-semibold mb-3" data-reveal id="msTitle">Miln√≠ky</h2>
      <div id="milestones" class="grid md:grid-cols-2 gap-4"></div>
    </section>

    <!-- Pauzy -->
    <section class="mb-10">
      <h2 class="text-xl md:text-2xl font-semibold mb-3" data-reveal id="gapsTitle">Ticha v de≈°ti</h2>
      <div id="gaps" class="grid md:grid-cols-2 gap-4"></div>
    </section>

    <!-- F√°ze -->
    <section class="mb-10">
      <h2 class="text-xl md:text-2xl font-semibold mb-3" data-reveal id="phTitle">F√°ze p≈ô√≠bƒõhu</h2>
      <div id="phases" class="grid md:grid-cols-3 gap-4"></div>
    </section>

    <div class="mt-8">
      <a class="btn inline-flex items-center gap-2 rounded-xl px-4 py-2" href="/index.html" id="back">‚Üê Zpƒõt</a>
    </div>
  </main>

  <footer class="text-center text-white/60 py-10 relative z-10">¬© AV ‚Äî 13</footer>

  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const LANG = localStorage.getItem('lang') || 'cs';
      const LOCALE = (LANG === 'ua' ? 'uk' : 'cs');

      function num(n){ return (n??0).toLocaleString(LOCALE); }
      function fmtDate(s){
        if(!s) return '‚Äî';
        const d = new Date(String(s).replace(' ','T'));
        return d.toLocaleDateString(LOCALE, { day:'2-digit', month:'2-digit', year:'numeric' });
      }
      const pick = (cs, ua)=> (LANG==='ua' ? (ua ?? cs) : (cs ?? ua));

      const T = (LANG==='ua') ? {
        title: "–î–æ—â –Ω–∞—Å –ø–æ—î–¥–Ω–∞–≤",
        sub:    (N)=>`13 –º—ñ—Å—è—Ü—ñ–≤ –º—ñ–∂ ${fmtDate(N.period?.start)} —ñ ${fmtDate(N.period?.end)}. –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å: ${num(N.totals?.all_incl_media)}. –î–≤—ñ—á—ñ —Ç–∏—à–∞ ‚Äî –∑–∞–≤–∂–¥–∏ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è.`,
        chips:  (N)=>[
          `‚ù§Ô∏è ${num(N.totals?.all_incl_media)} –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å`,
          `üìÖ ${num(N.totals?.days_active)} –¥–Ω—ñ–≤ —Ä–∞–∑–æ–º`,
          `üñºÔ∏è ${num(N.media?.images||0)} —Ñ–æ—Ç–æ ¬∑ üéûÔ∏è ${num(N.media?.videos||0)} –≤—ñ–¥–µ–æ`
        ],
        blocks: { milestones:"–í—ñ—Ö–∏", gaps:"–¢–∏—à–∞ –ø—ñ–¥ –¥–æ—â–µ–º", phases:"–§–∞–∑–∏ —ñ—Å—Ç–æ—Ä—ñ—ó", back:"‚Üê –ù–∞–∑–∞–¥" },
        kpiLbl: { total:"–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤—Å—å–æ–≥–æ", days:"–ê–∫—Ç–∏–≤–Ω—ñ –¥–Ω—ñ", avg:"–°–µ—Ä–µ–¥–Ω—î / –¥–µ–Ω—å",
                  pos:"–ü–æ–∑–∏—Ç–∏–≤–Ω—ñ", neg:"–ù–µ–≥–∞—Ç–∏–≤–Ω—ñ", gap:"–ù–∞–π–¥–æ–≤—à–∞ —Ç–∏—à–∞" },
        kpiDesc:{ total:"–°–ª–æ–≤–∞ —è–∫ –º—ñ—Å—Ç —á–µ—Ä–µ–∑ –±—É–¥—å-—è–∫—É –∑–ª–∏–≤—É.",
                  days:"–©–æ–¥–Ω—è ‚Äî –æ–¥–Ω–∞ –∫—Ä–∞–ø–ª—è. –†–∞–∑–æ–º ‚Äî –º–æ—Ä–µ.",
                  avg:"–†–∏—Ç–º —Å–µ—Ä—Ü—è, –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∏–π —É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.",
                  pos:"–°–æ–Ω—Ü–µ, —â–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –Ω–∞–≤—ñ—Ç—å –∫—Ä—ñ–∑—å —Ö–º–∞—Ä–∏.",
                  neg:"–î–æ—â, —è–∫–∏–π –Ω–∞–≤—á–∏–≤ –Ω–∞—Å –∑–±–ª–∏–∂—É–≤–∞—Ç–∏—Å—å.",
                  gap:"–ü–∞—É–∑–∞, –ø—ñ—Å–ª—è —è–∫–æ—ó –º–∏ –∑–Ω–æ–≤ –æ–±—Ä–∞–ª–∏ ¬´–Ω–∞—Å¬ª." },
        units:  { hours:" –≥–æ–¥" },
        gapWord: "–¢–∏—à–∞"
      } : {
        title: "D√©≈°≈• n√°s spojil",
        sub:    (N)=>`13 mƒõs√≠c≈Ø mezi ${fmtDate(N.period?.start)} a ${fmtDate(N.period?.end)}. Zpr√°v: ${num(N.totals?.all_incl_media)}. Dvakr√°t ticho, v≈ædy n√°vrat.`,
        chips:  (N)=>[
          `‚ù§Ô∏è ${num(N.totals?.all_incl_media)} zpr√°v`,
          `üìÖ ${num(N.totals?.days_active)} dn√≠ spolu`,
          `üñºÔ∏è ${num(N.media?.images||0)} fotek ¬∑ üéûÔ∏è ${num(N.media?.videos||0)} vide√≠`
        ],
        blocks: { milestones:"Miln√≠ky", gaps:"Ticha v de≈°ti", phases:"F√°ze p≈ô√≠bƒõhu", back:"‚Üê Zpƒõt" },
        kpiLbl: { total:"Zpr√°v celkem", days:"Dny aktivn√≠", avg:"Pr≈Ømƒõr / den",
                  pos:"Pozitivn√≠", neg:"Negativn√≠", gap:"Nejdel≈°√≠ ticho" },
        kpiDesc:{ total:"Slova jako mosty p≈ôes v≈°echny bou≈ôe.",
                  days:"Ka≈æd√Ω den kapka ‚Äî a mo≈ôe je na≈°e.",
                  avg:"Kadence srdce p≈ôepsan√° do zpr√°v.",
                  pos:"Slunce, kter√© pro≈°lo i skrz mraky.",
                  neg:"D√©≈°≈•, kter√Ω n√°s nauƒçil bƒõ≈æet bl√≠≈æ k sobƒõ.",
                  gap:"Pauza, po n√≠≈æ jsme si zvolili zase ‚Äûn√°s‚Äú." },
        units:  { hours:" h" },
        gapWord: "Ticho"
      };

      const N = window.NDATA || {};

      // Headline
      document.getElementById('ttl').textContent = T.title;
      document.getElementById('sub').textContent = T.sub(N);
      document.getElementById('msTitle').textContent = T.blocks.milestones;
      document.getElementById('gapsTitle').textContent = T.blocks.gaps;
      document.getElementById('phTitle').textContent  = T.blocks.phases;
      document.getElementById('back').textContent     = T.blocks.back;

      // Facts chips
      const facts = document.getElementById('facts');
      T.chips(N).forEach(txt=>{
        const el = document.createElement('span'); el.className='chip'; el.textContent = txt; facts.appendChild(el);
      });

      // KPI numbers
      const total = N.totals?.all_incl_media||0;
      const days  = N.totals?.days_active||0;
      const avg   = N.activity?.daily_avg_no_media || Math.round(total/(days||1));
      const pos   = N.sentiment?.positive_rate_percent||0;
      const neg   = N.sentiment?.negative_rate_percent||0;
      const longestGapH = (()=> {
        const gaps = (N.gaps||[]);
        let max = 0;
        for(const g of gaps){
          const h = g.hours ?? ((new Date(g.to)-new Date(g.from))/36e5);
          if (h>max) max=h;
        }
        return Math.round(max||0);
      })();

      // KPI labels + poetic lines
      k_lbl_total.textContent = T.kpiLbl.total; k_desc_total.textContent = T.kpiDesc.total;
      k_lbl_days.textContent  = T.kpiLbl.days;  k_desc_days.textContent  = T.kpiDesc.days;
      k_lbl_avg.textContent   = T.kpiLbl.avg;   k_desc_avg.textContent   = T.kpiDesc.avg;
      k_lbl_pos.textContent   = T.kpiLbl.pos;   k_desc_pos.textContent   = T.kpiDesc.pos;
      k_lbl_neg.textContent   = T.kpiLbl.neg;   k_desc_neg.textContent   = T.kpiDesc.neg;
      k_lbl_gap.textContent   = T.kpiLbl.gap;   k_desc_gap.textContent   = T.kpiDesc.gap;

      countUp('#k_total', total);
      countUp('#k_days',  days);
      countUp('#k_avg',   avg);
      countUp('#k_pos',   pos, '%');
      countUp('#k_neg',   neg, '%');
      countUp('#k_gap',   longestGapH, T.units.hours);

      function countUp(sel, to, suffix=''){
        const el = document.querySelector(sel);
        const dur = 900; const start = performance.now();
        const from = 0;
        function ease(x){ return 1 - Math.pow(1-x, 3); }
        function tick(t){
          const p = Math.min(1,(t-start)/dur);
          const val = Math.round(from + (to-from)*ease(p));
          el.textContent = (LOCALE==='uk'?val.toLocaleString('uk'):val.toLocaleString('cs')) + suffix;
          if(p<1) requestAnimationFrame(tick);
        }
        requestAnimationFrame(tick);
      }

      // Milestones
      (function renderMilestones(){
        const list = (N.milestones||[]).slice().sort((a,b)=>new Date(a.date)-new Date(b.date));
        const wrap = document.getElementById('milestones');
        if(!list.length){ wrap.innerHTML = `<div class="text-white/70">‚Äî</div>`; return; }
        list.forEach(m=>{
          const el = document.createElement('div');
          el.className = 'cardg';
          el.innerHTML = `
            <div class="badge">${fmtDate(m.date)}</div>
            <h3 class="text-white/90 mt-2">${pick(m.text_cs, m.text_ua) || ''}</h3>
          `;
          wrap.appendChild(el);
        });
      })();

      // Gaps
      (function renderGaps(){
        const wrap = document.getElementById('gaps');
        const gaps = (N.gaps||[]).slice().sort((a,b)=>new Date(a.from)-new Date(b.from));
        if(!gaps.length){ wrap.innerHTML = `<div class="text-white/70">‚Äî</div>`; return; }
        gaps.forEach(g=>{
          const hrs = Math.round(g.hours ?? ((new Date(g.to)-new Date(g.from))/36e5));
          const el = document.createElement('div'); el.className='cardg';
          el.innerHTML = `
            <div class="badge">${fmtDate(g.from)} ‚Üí ${fmtDate(g.to)}</div>
            <h3 class="text-white/90 mt-2">${T.gapWord} ‚âà ${hrs.toLocaleString(LOCALE)}${T.units.hours}</h3>
            <p class="text-white/70 mt-1">${pick(
              'Pauza, po kter√© jsme si znovu vybrali ‚Äûn√°s‚Äú.',
              '–ü–∞—É–∑–∞, –ø—ñ—Å–ª—è —è–∫–æ—ó –º–∏ –∑–Ω–æ–≤—É –æ–±–∏—Ä–∞–ª–∏ ¬´–Ω–∞—Å¬ª.'
            )}</p>
          `;
          wrap.appendChild(el);
        });
      })();

      // Phases
      (function renderPhases(){
        const wrap = document.getElementById('phases');
        const arr = (N.narrative_phases||[]);
        if(!arr.length){ wrap.innerHTML = `<div class="text-white/70">‚Äî</div>`; return; }
        arr.forEach((p,i)=>{
          const el = document.createElement('div');
          el.className = 'cardg';
          const title = pick(p.title_cs||`F√°ze ${i+1}`, p.title_ua||`–§–∞–∑–∞ ${i+1}`);
          const note  = pick(p.note_cs, p.note_ua);
          el.innerHTML = `
            <div class="badge">${(p.range||[]).join(' ‚Üí ') || '‚Äî'}</div>
            <h3 class="text-white mt-2 font-semibold">${title}</h3>
            ${note ? `<p class="text-white/75 mt-1">${note}</p>`:''}
          `;
          wrap.appendChild(el);
        });
      })();

      // jemn√Ω reveal
      document.querySelectorAll('[data-reveal]').forEach((el,i)=>{
        el.style.opacity=0; el.style.transform='translateY(12px) scale(.98)'; el.style.filter='blur(2px)';
        setTimeout(()=>{ el.style.transition='opacity .6s ease, transform .6s ease, filter .6s ease';
          el.style.opacity=1; el.style.transform='none'; el.style.filter='none'; }, 120*i + 150);
      });
    });
  </script>
</body>
</html>